mimarmuratdemir.com {
	# Compression
	encode zstd gzip

	# API requests to backend
	handle /api/* {
		reverse_proxy backend:8080 {
			header_up Host {host}
			header_up X-Real-IP {remote}
			header_up X-Forwarded-For {remote}
			header_up X-Forwarded-Proto {scheme}
		}
	}

	# All other requests to frontend
	# Note: Caddy automatically handles /.well-known/acme-challenge/* for Let's Encrypt
	handle {
		reverse_proxy frontend:80 {
			header_up Host {host}
			header_up X-Real-IP {remote}
			header_up X-Forwarded-For {remote}
			header_up X-Forwarded-Proto {scheme}
		}
	}

	# Security headers
	header {
		X-Content-Type-Options "nosniff"
		X-Frame-Options "DENY"
		X-XSS-Protection "1; mode=block"
		Referrer-Policy "no-referrer"
		Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
	}

	# Logging
	log {
		output stdout
		format console
	}
}

mimarmuratdemir.com {
	# Compression
	encode zstd gzip

	# Let's Encrypt ACME challenge (HTTP-01)
	# This MUST be handled first and must NOT redirect to HTTPS
	# Caddy automatically handles this path, but we need to ensure it's not redirected
	handle /.well-known/acme-challenge/* {
		# Caddy's built-in ACME handler will respond here
		# This path is excluded from auto HTTPS redirect
	}

	# API requests to backend
	handle /api/* {
		reverse_proxy backend:8080
	}

	# All other requests to frontend
	handle {
		reverse_proxy frontend:80
	}

	# Security headers
	header {
		X-Content-Type-Options "nosniff"
		X-Frame-Options "DENY"
		X-XSS-Protection "1; mode=block"
		Referrer-Policy "no-referrer"
		Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
	}

	# Logging
	log {
		output stdout
		format console
	}
}
